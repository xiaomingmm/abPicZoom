/*!
 * abPicZoom 结合 agilebins 的组图预览放大镜效果 http://ab.geshai.com/demo/demo1/demo.html
 * 更多详尽信息请看官网：http://ab.geshai.com/other-plus/abPicZoom/abPicZoom.html
 *  
 * 有疑难问题可选择QQ群① 158544200 或QQ群② 790370978 进行反馈
 * 
 * Carlo,Cloud,Trdiotr
 *
 * 请尊重原创，保留头部版权
 * 在保留版权的前提下可应用于个人或商业用途
 *
 */
;!function(a){a.fn.abPicZoom=function(b){function d(a){return a+"px"}function e(){return a.browser.msie&&a.browser.version<7}function f(){return y.attr(c.sn)==c.sv}function g(){return z.attr(c.sn)==c.sv}function h(a){return a.attr(c.sl)==c.sv}function i(a){return a.is(":hidden")}function j(a){return a.stop(!0,!0)}function k(a){var e,f,g,h;return null==a?!1:(e=Math.max(0,a.pageX-z.offset().left-F/2),f=Math.max(0,a.pageY-z.offset().top-G/2),e=(e+F>A?A-F:e)+(H-A)/2,f=(f+G>B?B-G:f)+(I-B)/2,null==J&&(J=parseFloat(z.attr(c.slw)||0),K=parseFloat(z.attr(c.slh)||0),(F>J||G>K)&&(J=A,K=B),E.css("width",d(F*J/A)),E.css("height",d(G*K/B))),g=e*J/A-(H-A)/2,h=f*K/B-(I-B)/2,E.find(c.i).css({left:d(-1*g),top:d(-1*h)}),E.css({top:d(y.offset().top),left:d(y.offset().left+y.outerWidth()+b.marginLeft)}),{left:d(e),top:d(f)})}function l(a){a.stopPropagation&&a.stopPropagation(),D.css(k(a))}function m(a){L=a,p(),j(D).fadeIn(b.speed),s()}function n(a){L=a,l(a)}function o(a){p(),a.stopPropagation&&a.stopPropagation(),i(D)||(j(D).fadeOut(b.speed),j(E).fadeOut(b.speed))}function p(){return M?(window.clearTimeout(M),void 0):!1}function q(a,b){var c=E.find("span");0==c.length&&(E.append('<span style="position:absolute;z-index:2;width:100%;height:100%;line-height:55px;font-size:14px;text-align:center;color:#666666;background-color:#FFFFFF;"></span>'),c=E.find("span")),c.html(b||"Loading..."),c.css("display",1==a?"block":"none")}function r(a,b,d){var e=new Image;e.onload=function(){"function"==typeof d&&d(e.width,e.height)},e.onerror=function(){z.attr(c.sl,c.sv)},e.src=b}function s(){return h(z)?(z.attr(c.slw)?q(!1):q(!0,b.errorTips),j(E).fadeIn(b.speed),E.find(c.i).attr("src",z.attr(b.previewSrcName)),l(L),!1):(r(E.find(c.i),z.attr(b.previewSrcName),function(a,d){J=K=null,z.attr(c.slw,a).attr(c.slh,d).attr(c.sl,c.sv),q(!1),j(E).fadeIn(b.speed),E.find(c.i).attr("src",z.attr(b.previewSrcName)),l(L)}),M=window.setTimeout(function(){return z.attr(c.slw)?!0:(q(!0),j(E).fadeIn(b.speed),E.find(c.i).attr("src",""),l(L),void 0)},b.delayTips),E.find(c.i).attr("src",""),void 0)}function t(b){if(e()){var f={position:"absolute",display:"block","z-index":-1,border:"none",top:d(0),left:d(0),filter:"mask(color=#fff)",width:d(a(window).width()),height:d(a(window).height())};b.append('<iframe id="'+c.ifr+'"></iframe>'),a("iframe[id='"+c.ifr+"']").css(f)}}function u(){var f,d="div[ab-selector='"+c.s+"']";return g()||(f='<div ab-selector="'+c.s+'" class="'+b.selectorClass+'" style="display:none;position:absolute; z-index:1;"></div>',C.append(f),e()&&a(d,C).css("background-color","#3D6ECE"),a(d,C).css("opacity",b.selectorOpacity)),a(d,C)}function v(){var e,d="div[ab-preview='"+c.p+"']";return f()||(e='<div ab-preview="'+c.p+'" class="'+b.previewClass+'" style="display:none;position:absolute;background-color:#FFFFFF;overflow:hidden;z-index:'+b.previewZindex+';"><img src="" style="position:absolute;" /></div>',y.append(e),t(a(d,y))),a(d,y)}function w(){if(g())return z.parent();var a='<div ab-wrap="'+c.w+'" class="'+b.selectorWrapClass+'" style="position:relative;"></div>';return z.wrap(a),z.parent().css("width",d(A)).css("height",d(B))}function x(){q(!1),E.scrollLeft(0).scrollTop(0),r(E.find(c.i),z.attr(b.previewSrcName),function(a,b){z.attr(c.slw,a).attr(c.slh,b).attr(c.sl,c.sv)}),C.unbind().mouseenter(m).mousemove(n).mouseleave(o),z.attr(c.sn,c.sv),y.attr(c.sn,c.sv)}var c,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M;a.fn.abPicZoom.defaults={_version:1,marginLeft:10,selectorWrapClass:"wrap",selector:"#img",selectorClass:"selector",selectorOpacity:.2,previewSrcName:"preview",previewClass:"preview",previewZindex:999,speed:0,delayTips:2500,errorTips:"Load failed."},b=a.extend({},a.fn.abPicZoom.defaults,b),c={i:"img",sl:"f03dx",slw:"f03dx-w",slh:"f03dx-h",sn:"abpzv",sv:"yes",w:"c7217b",s:"e1072d",p:"cd6a8e",ifr:"ea531b"},y=a(this),z=a(b.selector,y),A=z.width(),B=z.height(),C=w(),D=u(),E=v(),F=D.width(),G=D.height(),H=C.outerWidth(),I=C.outerHeight(),J=null,K=null,L=null,M=null,x()}}(jQuery);